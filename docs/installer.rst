.. _installer:

Развертывание из консольного инсталлятора
================================================

Для развертывания FindFace Security можно использовать консольный инсталлятор.


.. warning::
     Инсталлятор не предназначен для обновления FindFace Security.

.. warning::
   Для успешного функционирования системы после установки из инсталлятора, IP-адрес сервера должен быть статическим. Для того чтобы сделать IP-адрес статическим, откройте файл ``etc/network/interfaces`` и измените текущую запись для основного сетевого интерфейса так, как показано в примере ниже. Замените адреса в примере на актуальные с учетом настроек сети.

   .. code::

     sudo vi /etc/network/interfaces

     iface eth0 inet static
     address 192.168.112.144
     netmask 255.255.255.0
     gateway 192.168.112.254
     dns-nameservers 192.168.112.254

   Перезапустите сетевые интерфейсы.

   .. code::

      sudo service networking restart

   С осторожностью редактируйте файл ``etc/network/interfaces``. Перед тем как приступить к редактированию, ознакомьтесь с `инструкцией по настройке сетей <https://help.ubuntu.com/lts/serverguide/network-configuration.html#ip-addressing>`__ Ubuntu.  

.. seealso::
   
   * :ref:`deploy`


Для развертывания из инсталлятора выполните следующие действия:

#. Загрузите файл инсталлятора ``<findface-security-xxx>.run``.
#. Поместите файл ``.run`` в любую папку на сервере установки (например, ``/home/username``).
#. Из данной папки сделайте файл ``.run`` исполняемым.

   .. code::

       chmod +x <findface-security-xxx>.run

#. Запустите файл ``.run``.

   .. code::

       sudo ./<findface-security-xxx>.run

   Инсталлятор проверит, соответствует ли сервер системным требованиям. После этого компоненты FindFace Security будут автоматически установлены, настроены и запущены в соответствии со следующей конфигурацией:


   +-----------------------------+------------------------------------------------------------------------------------------------------+
   | Компонент                   | Особенности установки                                                                                |
   +=============================+======================================================================================================+
   | findface-postgres-facen     | Устанавливается и запускается.                                                                       |
   +-----------------------------+------------------------------------------------------------------------------------------------------+
   | ffsecurity                  | Устанавливается и запускается.                                                                       |
   +-----------------------------+------------------------------------------------------------------------------------------------------+
   | ffsecurity-ui               | Устанавливается и запускается.                                                                       |
   +-----------------------------+------------------------------------------------------------------------------------------------------+
   | fkvideo_detector 	         | Устанавливается и запускается.                                                                       |
   +-----------------------------+------------------------------------------------------------------------------------------------------+
   | findface-extraction-api     | Устанавливается и запускается.                                                                       |
   +-----------------------------+------------------------------------------------------------------------------------------------------+
   | NTLS 	                 | Устанавливается и запускается.                                                                       |
   +-----------------------------+------------------------------------------------------------------------------------------------------+  
   | nginx                       | Устанавливается и запускается.                                                                       |
   +-----------------------------+------------------------------------------------------------------------------------------------------+
   | База данных PostgreSQL      | Устанавливается и запускается в стандартной конфигурации.                                            |
   +-----------------------------+------------------------------------------------------------------------------------------------------+
   | Сетевое хранилище Redis     | Устанавливается и запускается.                                                                       |
   +-----------------------------+------------------------------------------------------------------------------------------------------+
   | jq 	                 | Устанавливается. Используется для структурирования API-ответов от FindFace Security в формате JSON.  |
   +-----------------------------+------------------------------------------------------------------------------------------------------+
 
#. По завершении установки в консоль будет выведена информация, необходимая для использования FindFace Security:

   .. tip::
       Обязательно сохраните эти данные: они вам понадобятся.     

   .. code::

      ###############################################
      #          Installation is complete           #
      ###############################################
      - upload your license to http://172.17.47.21:3185/
        login:          admin
        password:       0MBNics
      - user interface: http://172.17.47.21/
        superuser:      admin
        password:       admin
        documentation:  http://172.17.47.21/doc/

#. Загрузите файл лицензии через веб-интерфейс NTLS ``http://<IP_адрес_сервера>:3185/#/``. Для доступа в веб-интерфейс NTLS используйте логин и пароль, выведенные в консоли.

   .. note::
      IP-адрес сервера в ссылках на веб-интерфейсы FindFace имеет вид ``127.0.0.1`` или <IP_адрес_в_сети>, в зависимости от того, принадлежит ли сервер к сети.

.. important::
   Не передавайте данные ``superuser`` (Супер Администратора) третьим лицам. Для администрирования системы создайте назначаемого администратора. Отличие назначаемого администратора от Супер Администратора в том, что последний не может лишиться прав администратора даже при смене роли.       



